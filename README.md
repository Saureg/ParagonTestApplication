# Тестовое задание для Paragon Software
1. [Задание](#Задание)
1. [Описание](#Описание)
1. [Проекты](#Проекты)
1. [Методы](#Методы)
1. [Конфигурационные файлы](#Конфигурационные-файлы)
1. [Скрипты](#Скрипты)

## Задание
Необходимо разработать приложение/сервис с REST интерфейсом, позволяющее выполнять учёт запланированных вебинаров, а именно
* Добавление нового вебинара
* Изменение/Удаление ранее запланированного вебинара
* Выдачу имеющихся вебинаров через фильтрацию

Для вебинара необходимо хранить следующую информацию
* Уникальное название
* Не уникальное имя серии вебинаров
* Дата начала
* Время начала (достаточно точности до минуты)
* Длительность (опять же достаточно точности до минуты)

Сценарии фильтрации на GET-запросах
* Выдать все вебинары, активное время которых попадает хоть на 1 минуту в заданный промежуток дат и времени, задаваемый пользователем при поиске (пользователь при этом может задать как время начала интервала + время окончания интервала, так и только один их этих параметров)
* Выдать все вебинары, длительность которых попадает в диапазон от Min до Max, задаваемый пользователем (пользователь может указать или Min+Max или только один из них)
* Выдача вебинаров из заданной пользователем серии
* Любые комбинации перечисленных выше фильтраций

Таким образом самое сложное по выдаче, это кейс:
* Я как пользователь задаю фильтр:
  * Серия = VALUE
  * MinDataTime = VALUE
  * MaxDataTime = VALUE
  * MinDuration = VALUE
  * MaxDuration = VALUE
* И получаю выборку вебинаров из заданной серии не менее MinDuration и не более MaxDuration по длительности и хотя бы на 1 минуту пересекающихся с задаваемым промежутком от MInDataTime до MaxDataTime

Данное приложение должно быть покрыто автотестами.

Необязательная часть тестового задания:
Плюсом будет, если среди автотестов будет какое-то тестирование производительности и будут получены какие-либо его артефакты.

## Проекты 
**ParagonTestApplication** - проект, содержащий контроллеры, маппинги и конфигурации.

**ParagonTestApplication.Data** - проект для интерфейсов и реализации репозиториев. Содержит миграции.

**ParagonTestApplication.Models** - проект для моделей.

**ParagonTestApplication.ApiClient** - проект, помогающий работе с API в тестах.

**ParagonTestApplication.ApiTests** - API-тесты.

**ParagonTestApplication.PerformanceTests** - тесты производительности.

**ParagonTestApplication.UnitTests** - юнит-тесты.

## Описание
При выполнении тестового задания использовались следующие инструменты/фреймворки/пакеты:
* .NET Core 3.1 - платформа разработки
* PostgreSQL 12 - СУБД
* EntityFrameworkCore - ORM решение
* Automapper 8.0.1 - пакет для маппинга объектов
* Swashbuckle.AspNetCore 5.5.1 - пакет для интерактивного описания сервиса с помощью OpenAPI
* FluentValidation 9.0.1 - пакет для валидации моделей
* NUnit 3.12.0 - тестовый фреймворк 
* Shouldly 3.0.2 - пакет для проверок
* Microsoft.AspNetCore.TestHost - веб-сервер для прогона API тестов
* NBomber 1.0.0-rc - фреймворк для тестирования производительности
* Moq 4.14.5 - пакет для мокирования объектов

Для работы приложения необходима запущенная база данных. Файлы миграция хранятся по пути ~\ParagonTestApplication.Data\Migrations

## Методы
### GET /api/webinar/{id} - получение вебинара
* id - идентификатор вебинара
### GET /api/webinar - получение списка вебинаров
*Параметры фильтрации:*
* MinDateTime - начало диапазона по дате и времени (в формате yyyy-MM-ddTHH:mm)
* MaxDateTime - конец диапазона по дате и времени (в формате yyyy-MM-ddTHH:mm)
* MinDuration - минимальная продолжительность вебинара
* MaxDuration - максимальная продолжительности вебинара
* SeriesId - идентификатор серии вебинаров
* PageNumber - номер страницы
* PageSize - количество записей на странице
### POST /api/webinar - создание нового вебинара
*Параметры запроса:*
* name - Название вебинара
* startDateTime - Дата и время начала вебинара (в формате yyyy-MM-ddTHH:mm)
* duration - Продолжительность вебинара (в минутах)
* series - данные о серии вебинаров. Содержит параметр name - название серии.

Если при создании нового вебинара будет указано название серии, которой не существует, то создатся новая серия вебинаров.
Если при создании нового вебинара будет указано название серии, которая существует, то будет использоваться существующая серия вебинаров.
### PUT /api/webinar/{id} - изменение вебинара 
*Параметры запроса:*
* name - Название вебинара
* startDateTime - Дата и время начала вебинара (в формате yyyy-MM-ddTHH:mm)
* duration - Продолжительность вебинара (в минутах)
* series - данные о серии вебинаров. Содержит параметр name - название серии.

Если при изменении существующего вебинара будет указано название серии, которой не существует, то создатся новая серия вебинаров.
Если при создании нового вебинара будет указано название серии, которая существует, то будет использоваться существующая серия вебинаров.
### DELETE /api/webinar/{id} - удаление вебинара
* id - идентификатор вебинара
### GET /api/series - получение списка всех серий вебинаров
---
Интерактивное описание REST API можно посмотреть с помощью OpenAPI по адресу *<service_url>/swagger* (или *<service_url>/swagger/index.html*)

## Конфигурационные файлы

#### ~\ParagonTestApplication\appsettings.json
Необходим для работы приложения. В этой файле содержится информация о подключении к базе. В конфигурационном файле из репозитория необходимо указать сервер базы данных, порт, название базы данных, имя пользователя и пароль.

#### ~\ParagonTestApplication.ApiTests\appsettings.json
Необходим для выполнения API тестов. В этой файле содержится информация о подключении к базе. В конфигурационном файле из репозитория необходимо указать сервер базы данных, порт, название базы данных, имя пользователя и пароль.

#### ~\ParagonTestApplication.PerformanceTests\config.json
Необходим для выполнения тестов производительности. В этой файле содержатся настройки запуска тестирования производительности. В конфигурационном файле содержатся следующие параметры:
* Url - адрес приложения
* Duration - продолжительность запуска (в минутах)
* MinPause - минимальная пауза между выполнением запросов (в секундах)
* MaxPause - максимальная пауза между выполнением запросов (в секундах)
* InjectionRates - профили нагрузки, содержащие:
  * Name - название профиля
  * Pause - пауза между выполнением сценариев (в секундах)
  * ThreadCount - количестов потоков (виртуальных пользователей)
  
## Скрипты
#### ~\scripts\run_api_tests.ps1
Запуск API тестов. Необходима запущенная база данных, данные о подключении которой необходимо указать в конфигурационном файле ~\ParagonTestApplication.ApiTests\appsettings.json

#### ~\scripts\run_performance_tests.ps1
Запуск тестов производительности. Необходим работающий сервис. Конфигурация нагрузочных тестов описывается в файле ~\ParagonTestApplication.PerformanceTests\config.json

  
